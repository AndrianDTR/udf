#ifndef __udfMainFrameBase__
#define __udfMainFrameBase__

/**
@file
Subclass of MainFrameBase, which is generated by wxFormBuilder.
*/

#include "udf.h"

#include "tchampionship.h"
#include "tcountries.h"
#include "tcities.h"
#include "tchampionshiptype.h"
#include "cdbmanager.h"

typedef enum{
	IT_CS = 0,
	IT_BLOCK,
	IT_CAT,
	IT_TOUR,
}eITEM_TYPE;

class udfTreeItemData : public wxTreeItemData
{
public:
    udfTreeItemData(const unsigned long nId, eITEM_TYPE type) : m_nId(nId), m_type(type) { }

    void 			ShowInfo(wxTreeCtrl *tree);
    const wxChar*	GetDesc() const { return wxString::Format("%ld", m_nId).c_str(); }
	unsigned long	GetId() const {return m_nId; }
	eITEM_TYPE		GetType()const {return m_type; }

private:
	eITEM_TYPE		m_type;
    unsigned long 	m_nId;
};

/** Implementing MainFrameBase */
class udfMainFrameBase : public MainFrameBase
{
protected:
	// Handlers for MainFrameBase events.
	void OnCloseFrame( wxCloseEvent& event );
	void OnExitClick( wxCommandEvent& event );
	void OnMenuCategoryManage( wxCommandEvent& event );
	void OnMenuClubManage( wxCommandEvent& event );
	void OnMenuJudgeManage( wxCommandEvent& event );
	void OnMenuChampionshipTypes( wxCommandEvent& event );
	void OnAddChampionsip( wxCommandEvent& event );
	void OnRemoveChampionship( wxCommandEvent& event );
	void OnCategoryMngr( wxCommandEvent& event );
	void OnStartNumberAssign( wxCommandEvent& event );
	void OnJudgeMngr( wxCommandEvent& event );
	void OnSendInvitation( wxCommandEvent& event );
	void OnSave( wxCommandEvent& event );
	void OnDiscard( wxCommandEvent& event );
	void OnAboutDlg( wxCommandEvent& event );
	void OnDancersTeams( wxCommandEvent& event );

	void OnDanceTypesCodeMgr( wxCommandEvent& event );
	void OnLigueCodeMgr( wxCommandEvent& event );
	void OnAgeCodesMgr( wxCommandEvent& event );

	void OnCountriesMngr( wxCommandEvent& event );
	void OnCitiesMngr( wxCommandEvent& event );

	void OnSearch( wxCommandEvent& event );
	void OnCsSelect(wxTreeEvent& event);

	void OnAddTour( wxCommandEvent& event );
	void OnRemoveTour( wxCommandEvent& event );
	void OnCsTourReport( wxCommandEvent& event );
	void OnJudgesMark( wxCommandEvent& event );
	void OnEditTour(wxTreeEvent& event) {EditTourInfo();};
	void OnTourEdit(wxCommandEvent& event) {EditTourInfo();};
	void EditTourInfo();

private:
	CDbConnection*						m_pCon;
	CChampionshipTable::tTableMap		m_Championships;
	CCountriesTable::tTableMap			m_Countries;
	CCitiesTable::tTableMap				m_Cities;
	CChampionshipTypeTable::tTableMap 	m_ChampionshipTypes;

	wxTreeItemId						m_root;

protected:
	void			RefreshList();
	void			RefreshCs(unsigned int id, wxTreeItemId parent);
	void			RefreshCsBlock(unsigned int id, wxTreeItemId parent);
	void			RefreshCategory(unsigned int id, wxTreeItemId parent);

	void			RefreshCities();
	void			RefreshCountries();
	void			RefreshTypes();
	int				GetSelectedCity();
	int				GetSelectedType();

	bool			ValidateValues();

	wxDateTime		GetChDateById(unsigned int nId);

	wxTreeItemId	GetItemByType(eITEM_TYPE type);
	wxTreeItemId	GetSelectedCs();
	wxTreeItemId	GetSelectedCsTour();
	wxTreeItemId	GetSelectedCsCategory();

	bool			IsFinalTourAdded();

public:
	/** Constructor */
	udfMainFrameBase( wxWindow* parent );

public:
	int ShowDanceTypesMngrDlg();
	int ShowLiguesMngrDlg();
	int ShowAgeCatsMngrDlg();

};

#endif // __udfMainFrameBase__
